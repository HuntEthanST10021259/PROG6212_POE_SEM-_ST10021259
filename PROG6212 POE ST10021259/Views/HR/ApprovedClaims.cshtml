@model List<PROG6212_POE_ST10021259.Models.Claim>
@{
    ViewData["Title"] = "Approved Claims";
}

<div class="container mt-4">
    <h2 class="mb-4"><i class="bi bi-check-circle"></i> Approved Claims</h2>

    <div class="mb-3">
        <a asp-action="GenerateInvoice" class="btn btn-success">
            <i class="bi bi-receipt"></i> Generate Bulk Invoice
        </a>
        <a asp-action="PaymentReport" class="btn btn-primary">
            <i class="bi bi-file-bar-graph"></i> Payment Report
        </a>
        <a asp-action="Dashboard" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Back to Dashboard
        </a>
    </div>

    @if (Model == null || !Model.Any())
    {
        <div class="alert alert-info">No approved claims found.</div>
    }
    else
    {
        <div class="table-responsive">
            <table class="table table-hover table-bordered">
                <thead class="table-dark">
                    <tr>
                        <th>ID</th>
                        <th>Submitted</th>
                        <th>Approved</th>
                        <th>Hours</th>
                        <th>Rate</th>
                        <th>Total</th>
                        <th>Approved By</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var claim in Model.OrderByDescending(c => c.ManagerApprovedDate))
                    {
                        <tr>
                            <td><strong>#@claim.Id</strong></td>
                            <td>@claim.DateSubmitted.ToString("dd/MM/yyyy")</td>
                            <td>@claim.ManagerApprovedDate?.ToString("dd/MM/yyyy")</td>
                            <td>@claim.HoursWorked hrs</td>
                            <td>R @claim.HourlyRate.ToString("F2")</td>
                            <td><strong class="text-success">R @claim.TotalAmount.ToString("F2")</strong></td>
                            <td>@claim.ManagerApprovedBy</td>
                            <td>
                                <a asp-action="GenerateInvoice" asp-route-id="@claim.Id" class="btn btn-sm btn-outline-success">
                                    <i class="bi bi-receipt"></i> Invoice
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
                <tfoot class="table-success">
                    <tr>
                        <td colspan="5" class="text-end"><strong>Total:</strong></td>
                        <td colspan="2"><strong>R @Model.Sum(c => c.TotalAmount).ToString("F2")</strong></td>
                    </tr>
                </tfoot>
            </table>
        </div>
    }
</div>